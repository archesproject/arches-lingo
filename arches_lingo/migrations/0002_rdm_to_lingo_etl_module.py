# Generated by Django 4.2.8 on 2024-01-05 11:08

from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        ('arches_lingo', '0001_initial'),
        ('models', '10260_add_iiifmanifest_globalid'),
    ]

    add_migrate_to_lingo = """
        INSERT INTO etl_modules (
            etlmoduleid,
            name,
            description,
            etl_type,
            component,
            componentname,
            modulename,
            classname,
            config,
            icon,
            slug,
            helpsortorder,
            helptemplate,
            reversible)
        VALUES (
            '11cad3ca-e155-44b1-9910-c50b3def47f6',
            'Migrate to Lingo',
            'Migrate schemes and concepts from the RDM to Arches Lingo',
            'import',
            'views/components/etl_modules/migrate-to-lingo',
            'migrate-to-lingo',
            'migrate_to_lingo.py',
            'RDMMtoLingoMigrator',
            '{"bgColor": "#ffa564", "circleColor": "#ffd2b1", "show": true}',
            'fa fa-usb',
            'migrate-to-lingo',
            6,
            'migrate-to-lingo-help',
            true);
        """
    remove_migrate_to_lingo = """
        DELETE FROM load_staging WHERE loadid IN (SELECT loadid FROM load_event WHERE etl_module_id = '11cad3ca-e155-44b1-9910-c50b3def47f6');
        DELETE FROM load_errors WHERE loadid IN (SELECT loadid FROM load_event WHERE etl_module_id = '11cad3ca-e155-44b1-9910-c50b3def47f6');
        DELETE FROM load_event WHERE etl_module_id = '11cad3ca-e155-44b1-9910-c50b3def47f6';
        DELETE FROM etl_modules WHERE etlmoduleid = '11cad3ca-e155-44b1-9910-c50b3def47f6';
    """

    #TODO: Remove operation before shipping to users
    show_etl_manager = """
        UPDATE plugins SET config = '{"show": true}' WHERE pluginid = '7720e9fa-876c-4127-a77a-b099cd2a5d45';
    """
    hide_etl_manager = """
        UPDATE plugins SET config = '{"show": false}' WHERE pluginid = '7720e9fa-876c-4127-a77a-b099cd2a5d45';
    """

    operations = [
        migrations.RunSQL(
            add_migrate_to_lingo,
            remove_migrate_to_lingo,
        ),
        migrations.RunSQL(
            show_etl_manager,
            hide_etl_manager,
        ),
    ]
